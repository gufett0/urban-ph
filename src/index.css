@tailwind base;
@tailwind components;
@tailwind utilities;

html {
  scroll-behavior: auto;
}

body {
  @apply font-sans;
}

:root {
  /* fallback: vecchi browser → 100vh */
  --stable-viewport-height: 100vh;
  /* alias usato in alcune regole */
  --viewport-height: var(--stable-viewport-height);
}

/* browser moderni: usa sempre la “small viewport height” */
@supports (height: 100svh) {
  :root {
    --stable-viewport-height: 100svh;
    --viewport-height: 100svh;
  }
}

/* Override del Tailwind min-h-screen per usare altezza stabile */
.min-h-screen {
  min-height: var(--stable-viewport-height);
}


/* Specifico per Hero section - fissa l'altezza */
.hero-container {
  height: var(--stable-viewport-height);
  min-height: var(--stable-viewport-height);
  max-height: var(--stable-viewport-height);
  overflow: hidden;
}

/* (opzionale) Override del Tailwind min-h-screen per usare altezza stabile */
.relative.min-h-screen {
  height: var(--stable-viewport-height);
  min-height: var(--stable-viewport-height);
  overflow: hidden;
}
/* Utility per overlay full-screen stabili (scrim, modali full) */
.fixed-full {
  position: fixed;
  inset: 0;
  height: var(--stable-viewport-height);
}


/* iOS specific: Momentum scrolling and viewport stabilization */
@supports (-webkit-overflow-scrolling: touch) {
  html {
    height: -webkit-fill-available;
  }
  body {
    min-height: -webkit-fill-available;
    overflow-y: auto;
    -webkit-overflow-scrolling: touch;
  }
  #root {
    min-height: -webkit-fill-available;
    display: flex;
    flex-direction: column;
  }
}

/* Dynamic height fix for iOS (will be set via JS) */
body, #root {
  height: auto !important; /* Override if JS sets it */
}

/* GPU acceleration for animations (add to EventCard/Info wrappers) */
.animated-element, .event-card, .info-section {
  will-change: transform, opacity;
  backface-visibility: hidden; /* Extra for iOS jank */
  transform: translate3d(0, 0, 0); /* Force hardware acceleration */
}

/* Ottimizzazioni mobile leggere */
@media (max-width: 768px) {
  .transition-height {
    transition-duration: 200ms !important; /* Shorter for smoother feel */
  }
}

/* Stabilizza il contenuto durante lo scroll su mobile */
@media (max-width: 768px) and (hover: none) and (pointer: coarse) {
  /* Riduce il jank durante gli scroll rapidi */
  * {
    -webkit-backface-visibility: hidden;
    backface-visibility: hidden;
  }
  
  /* Stabilizza la sezione Hero che probabilmente causa il glitch principale */
  .relative.min-h-screen {
    height: var(--viewport-height);
    min-height: var(--viewport-height);
    overflow: hidden; /* Previene scroll inaspettati */
  }
  
  /* Forza una stabilità maggiore per gli elementi posizionati in modo assoluto */
  .absolute {
    will-change: auto; /* Riduce l'overhead GPU se non necessario */
  }
}

/* Migliora la gestione dello scroll su iOS */
@media (max-width: 768px) {
  html {
    /* Stabilizza l'altezza durante le transizioni della barra del browser */
    height: var(--viewport-height);
    height: 100%;
  }
  
  body {
    overscroll-behavior-y: none;
  }
}